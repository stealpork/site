<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Профиль пользователя - {{ us }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='user_page.css') }}">
</head>
<body>

    <header>
        <h1 class="site-title">Repirok</h1>
        <nav>
            <ul>
            <li><a href="{{ url_for('main_page') }}">Найти репетитора</a></li>
            <li><a href="{{ url_for('chats')}}">Чаты</a></li>
            <li><a href="{{ url_for('user_profile', username=current_user.username) }}">Профиль</a></li>
            <li class="profile-icon"><img src="{{ url_for('static', filename='users_avatars/' + current_user.image_file) }}" alt="Профиль"></li>
            </ul>
        </nav>
    </header>

    <main class="profile-container">
        <form method="POST"  enctype="multipart/form-data">
        <div class="profile-info">
            <label>Имя</label>
            <input type="text" value="{{ us }}" readonly>

            <label>Специализация</label>
            <input type="text" name="spezialize" value="{{ spec or '' }}">

            <label>Возраст</label>
            <input type="number" name="age" value="{{ age or '' }}">

            <label>Обо мне</label>
            <textarea name="about">{{ about or '' }}</textarea>
        </div>

        <div class="profile-image-section">
            <div class="profile-avatar">
                <img src="{{ url_for('static', filename=default_avatar_url) }}" alt="Аватар пользователя">
            </div>
            <label for="file">Выбрать фото:</label>
            <input type="file" id="file" name="file" class="cta-button"><br><br>
            <button class="cta-button" type="submit">Принять изменения</button>
        </div>
        </form>
        {% if message %}
                <div id="myModal" class="modal">
                  <div class="modal-content">
                    <span class="close" onclick="closeModal()">&times;</span>
                    <p>{{ message }}</p>
                    <button onclick="goToRedirect()">OK</button>
                  </div>
                </div>
                <script>
                // Get the modal
                var modal = document.getElementById("myModal");

                // Function to open the modal
                function openModal() {
                  modal.style.display = "block";
                }

                // Function to close the modal
                function closeModal() {
                  modal.style.display = "none";
                }

                // When the user clicks anywhere outside of the modal, close it
                window.onclick = function(event) {
                  if (event.target == modal) {
                    closeModal();
                  }
                }

                function goToRedirect() {
                    window.location.href = "{{ url_for('redirect_after_ok', username=us) }}";
                }
                openModal();
                </script>
            {% endif %}
    </main>

</body>
</html>